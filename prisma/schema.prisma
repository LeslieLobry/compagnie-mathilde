generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model SiteSettings {
  id           Int     @id @default(1)
  heroTitle    String
  heroSubtitle String
  heroText     String

  // URL complète de l'image hébergée sur S3
  heroImage    String?

  // Clé S3 pour pouvoir supprimer/remplacer proprement (ex: hero/hero-123.jpg)
  heroImageKey String?
}

model Spectacle {
  id           Int              @id @default(autoincrement())
  title        String
  subtitle     String?
  description  String?
  texte        String?          // auteur·rice
  mes          String?          // mise en scène
  distribution String?
  autresInfos  String?

  dossierPath  String?          // URL du PDF (dossier presse / artistique)
  photos       SpectaclePhoto[]

  createdAt    DateTime         @default(now())
  updatedAt    DateTime         @updatedAt
}

model SpectaclePhoto {
  id          Int        @id @default(autoincrement())
  spectacle   Spectacle  @relation(fields: [spectacleId], references: [id], onDelete: Cascade)
  spectacleId Int

  // URL S3 complète de la photo
  imagePath   String

  // Clé S3 (ex: spectacles/12/photo-abc.jpg) pour delete
  storageKey  String?

  legend      String?
  order       Int        @default(0)
  createdAt   DateTime   @default(now())
}

model AgendaItem {
  id          Int      @id @default(autoincrement())
  period      String   // ex : "Mars → Mai 2026"
  title       String   // ex : "Création — Théâtre de l'Essaïon (Paris)"
  location    String?  // ex : "Paris", "Normandie..."
  description String?  // texte libre
  order       Int      @default(0) // pour trier l'affichage
  createdAt   DateTime @default(now())
}

model MediaItem {
  id        Int      @id @default(autoincrement())
  title     String?  // titre optionnel
  legend    String?  // légende / crédit

  // URL S3 complète (ex: https://.../medias/photo-xxx.jpg)
  imagePath String

  // Clé S3 interne (ex: medias/photo-xxx.jpg)
  storageKey String?

  order     Int      @default(0)
  createdAt DateTime @default(now())
}

model GalleryImage {
  id         Int      @id @default(autoincrement())
  title      String?
  alt        String?

  // URL S3
  imageUrl   String

  // clé S3 pour retrouver/supprimer le fichier sur S3
  storageKey String?

  createdAt  DateTime @default(now())
}
